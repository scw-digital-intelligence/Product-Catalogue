<!DOCTYPE html>
<html lang="en-gb">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link rel="stylesheet" href="assets/styles/global.css" type="text/css" />
        <link rel="stylesheet" href="assets/styles/media_queries.css" type="text/css" />
    </head>
    <body>
        <div id="nav-body">
            <div class="nav-container">
                <ul class="nav-menu">
                    <li><a href="./index.html">Home</a></li>
                    <li><a href="./catalogue.html">Catalogue</a></li>
                    <li><a href="https://scwcsu.sharepoint.com/sites/InsightsPortal" target="_blank">Insights</a></li>
                </ul>
            </div>
            <div id="filter-container" class="filter-container">
                <ul class="filter-menu">
                    <li id="portfolio-filter"><span class="filter-text">Portfolios</span><i id="portfolio-filter-chevron" class="nav-chevron portfolio-filter fa-solid fa-chevron-down fa-2xs"></i></li>
                    <li id="product-filter"><span class="filter-text">Products</span><i id="product-filter-chevron" class="nav-chevron product-filter fa-solid fa-chevron-down fa-2xs"></i></li>
                    <li id="platform-filter"><span class="filter-text">Platforms</span><i id="platform-filter-chevron" class="nav-chevron platform-filter fa-solid fa-chevron-down fa-2xs"></i></li>
                </ul>
            </div>
            <ul id="portfolio-filter-list" class="hide-filter"></ul>
            <ul id="product-filter-list" class="hide-filter"></ul>
            <ul id="platform-filter-list" class="hide-filter"></ul>            
        </div>
        <div id= "filter-box-container" class="filter-box-container">
            <div class="filter-row-container">
                <div class="filter-content">
                    <div class="filter-content-portfolios"></div>
                    <div class="filter-content-products"></div>
                    <div class="filter-content-platforms"></div>
                </div>
            </div>
        </div>
        <script>
            // base filter class to create three seperate filters from
            class Filter {
                constructor(content, className){
                    this.content = content;
                    this.filteredContent = this.content;
                    this.className = className;
                    this.createFilter();
                }

                // method to generate a filter list when a new object is created
                createFilter(){
                    let i, list;
                    i = 1;
                    list = document.getElementById(this.className + "-filter-list");

                    this.filteredContent.forEach(function(item){
                        let new_filter = document.createElement("input");
                        new_filter.setAttribute("type", "checkbox");
                        new_filter.setAttribute("id", "filter-" + i);
                        new_filter.setAttribute("name", "filter-" + i);
                        new_filter.setAttribute("value", item);

                        let new_label = document.createElement("label");
                        new_label.setAttribute("for", "filter-" + i);
                        new_label.textContent = item;

                        let newListItem = document.createElement("li");
                        newListItem.setAttribute("id", "filter-list-" + i);

                        newListItem.appendChild(new_filter);
                        newListItem.appendChild(new_label);

                        list.appendChild(newListItem);

                        i++
                    });
                }

                filtering(getThis){
                    this.filteredContent = this.content.filter((item) => item == getThis)
                }
            }

            let portfolioFilter, productFilter, platformFilter;
            portfolioFilter = new Filter(portfolioList, "portfolio");
            productFilter = new Filter(productList, "product");
            platformFilter = new Filter(platformList, "platform");
            
        </script>
        <script>
            function invertChevrons(){
                const filter_chevrons = document.getElementsByClassName('nav-chevron');

                for(i = 0; i < filter_chevrons.length; i++){
                    let filter = filter_chevrons[i].parentElement
                    // function to make the clicked filter item active
                    filter.onclick = function(){
                        if(this.classList.contains("filter-active")){
                            this.classList.remove("filter-active");

                            if(this.id == "portfolio-filter"){
                                document.getElementById(id="portfolio-filter-list").classList.add("hide-filter");
                            } else if(this.id == "product-filter"){
                                document.getElementById(id="product-filter-list").classList.add("hide-filter");
                            } else if(this.id == "platform-filter"){
                                document.getElementById(id="platform-filter-list").classList.add("hide-filter");
                            }
                            
                        } else {
                            this.classList.add("filter-active");

                            if(this.id == "portfolio-filter"){
                                document.getElementById(id="portfolio-filter-list").classList.remove("hide-filter");
                            } else if(this.id == "product-filter"){
                                document.getElementById(id="product-filter-list").classList.remove("hide-filter");
                            } else if(this.id == "platform-filter"){
                                document.getElementById(id="platform-filter-list").classList.remove("hide-filter");
                            }
                        }
                    }

                    // filter.onmousedown = filterUsed;
                }  
            }
        </script>
        <script>
            // functions accessed on page load
            window.addEventListener('load', invertChevrons);
        </script>
    </body>
</html>